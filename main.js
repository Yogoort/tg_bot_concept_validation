(()=>{"use strict";function e(e,n){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,n){if(e){if("string"==typeof e)return t(e,n);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){o&&(e=o);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,s=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){s=!0,c=e},f:function(){try{l||null==o.return||o.return()}finally{if(s)throw c}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}!function(){var t,n,o,r,a,c,l=document.getElementById("gameCanvas"),s=l.getContext("2d"),i=!1,u=75,d=1,g=3,f=[],m=100,p=100,y=.4*m,v=.4*p,h=[],b=310,w=!1,I=0,E=0,x=0,B=1.5,L=3,S=.75,_=10,k=!1,M=!1,T=0,A=.2,C=30,D="Arial, sans-serif",q=60,R=q,O="black",G=.5,j=!1,z=document.getElementById("audio-loop-2"),H=document.getElementById("audio-explosion"),N={background:{src:"assets/png/BG_1.png"},car:{src:"assets/png/car.png"},road:{src:"assets/png/road.jpg"},cursor:{src:"assets/png/cursor.png"},obstacle:{src:"assets/png/tree.png"},explosion:{src:"assets/png/boom.png"},logo_swan:{src:"assets/png/logo.png"},timerIcon:{src:"assets/png/timer.png"},leftButton:{src:"assets/png/bttn.png"},rightButton:{src:"assets/png/bttn.png"},welcome_bg:{src:"assets/png/BG_1.png"},logo_txt:{src:"assets/png/LOGO_txt.png"},sec60_logo:{src:"assets/png/60sec-logo.png"},play_button:{src:"assets/png/BTTN-Blue.png"},game_over_bg:{src:"assets/png/BG_win.png"},screen_from_movie:{src:"assets/png/Screen-from-movie.png"},youtube_btn:{src:"assets/png/youtube_btn.png"},mono_btn:{src:"assets/png/mono.png"},privat_btn:{src:"assets/png/privat.png"}};document.addEventListener("DOMContentLoaded",$),document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("welcome-screen"),t=document.getElementById("play-button"),n=document.querySelector(".youtube-button"),o=document.querySelector(".support-buttons");document.getElementById("game-over").style.display="none",document.getElementById("game-over").style.opacity="0",function(){var r=0,a=Object.keys(N).length;for(var c in N){var s=new Image;s.onload=function(){++r===a&&(e.style.backgroundImage="url(".concat(N.welcome_bg.src,")"),e.style.display="flex",n.addEventListener("click",(function(){z.pause()})),o.addEventListener("click",(function(){z.pause()})),j=!1,t.addEventListener("click",(function(){z.play(),e.style.display="none",l.style.display="block",j=!0,J(),P=1e3/60,X=Date.now(),ae()})))},s.src=N[c].src,N[c].element=s}}()})),l.addEventListener("click",U),l.addEventListener("touchstart",U);var P,X,Y=0,F=200;function U(e){if(!k){var o=Date.now();if(!(o-Y<F)){var r="click"===e.type?e.clientX:e.touches[0].clientX;("click"===e.type?e.clientY:e.touches[0].clientY)>n-80-20&&(r<100&&d>0?(d--,Y=o):r>t-80-20&&d<g-1&&(d++,Y=o)),ce()}}}function W(){t=window.innerWidth,n=window.innerHeight,l.width=t,l.height=n,r=t/g*d+(t/g-u)/2}function $(){document.getElementById("welcome-screen"),document.getElementById("play-button"),document.querySelector(".logo-txt"),document.querySelector(".sec60-logo")}function J(){j&&(document.querySelector(".tutorial-popup")||((o=document.createElement("div")).className="tutorial-popup",o.innerHTML='\n        <h2>Виконай рятувальну місію!</h2>\n        <div class="separator"></div> \x3c!-- Белая линия --\x3e\n        <p>Оминай перешкоди, тиснучи на стрілки.\n        <br>В тебе <b>'.concat(R,' </b> секунд.</br></p>\n        <div class="separator"></div> \x3c!-- Белая линия --\x3e\n        <h2>Успіху!</h2>\n    '),document.body.appendChild(o),l.addEventListener("click",(function(){K(),ce()}))))}function K(){j=!1,o&&(o.style.display="none")}function Q(){var e=Math.floor(Math.random()*g),n=t/g*e+(t/g-m)/2,o=60*(Math.random()-.5);f.push({x:n,y:-p,rotation:o})}function V(){var e=Math.random()*t/2,n=-b;h.push({x:e,y:n,frame:0,timer:0,delay:60*S})}function Z(){E=0,x=0,H.pause(),H.currentTime=0,w=!1}function ee(){k=!0,M=!0,T=0,clearInterval(ne),clearInterval(oe),w=!0,H.pause(),H.currentTime=0}window.addEventListener("resize",W),W(),window.addEventListener("resize",$);var te,ne,oe,re=Date.now();function ae(){var o,l,B;requestAnimationFrame(ae),re=Date.now(),(te=re-X)>P&&(X=re-te%P,s.clearRect(0,0,t,n),l=N.road.element,B=s.createPattern(l,"repeat"),s.fillStyle=B,s.save(),s.translate(E,x),s.translate(0,I),s.fillRect(0,-l.height,t,n+l.height),s.restore(),k||(I+=13)>=l.height&&(I=0),(o=s.createLinearGradient(0,0,0,120)).addColorStop(0,"rgba(0, 0, 0, 0.7)"),o.addColorStop(1,"rgba(0, 0, 0, 0)"),s.fillStyle=o,s.fillRect(0,0,t,120),function(){var t,o=N.obstacle.element,r=e(f);try{for(r.s();!(t=r.n()).done;){var a=t.value;s.save(),s.translate(a.x+m/2+E,a.y+p/2+x),s.rotate(a.rotation*Math.PI/180),s.drawImage(o,-m/2,-p/2,m,p),s.restore(),k||(a.y+=13)}}catch(e){r.e(e)}finally{r.f()}k||(f=f.filter((function(e){return e.y<n})))}(),function(){var t,o=N.explosion.element,r=Math.sqrt(25),a=o.width/r,c=o.height/r,l=e(h);try{for(l.s();!(t=l.n()).done;){var i=t.value;if(!(i.y>=n))if(i.delay>0)i.delay,i.delay--,k||(i.y+=13);else{if(i.frame<25){var u=i.frame%r*a,d=Math.floor(i.frame/r)*c;s.drawImage(o,u,d,a,c,i.x+E,i.y+x,310,b),w||(H.play(),w=!0),k||(i.timer+=1,i.timer>=1&&(i.frame++,i.timer=0,E=Math.random()*_-_/2,x=Math.random()*_-_/2,setTimeout(Z,1e3*S)))}k||(i.y+=13)}}}catch(e){l.e(e)}finally{l.f()}k||(h=h.filter((function(e){return e.y<n&&e.frame<25})))}(),function(){var e=N.car.element;r+=.2*(t/g*d+(t/g-u)/2-r);var o=n-150-100;s.drawImage(e,r+E,o+x,u,150)}(),function(){var e=80,o=N.leftButton.element;s.drawImage(o,20,n-e-20,e,e);var r=N.rightButton.element;s.save(),s.scale(-1,1),s.drawImage(r,20-t,n-e-20,e,e),s.restore()}(),k||(function(){console.log("detectCollision"),console.log(f);var t,o=e(f);try{for(o.s();!(t=o.n()).done;){var a=t.value,c=a.x+m/2,l=a.y+p/2,s=c-y/2,i=c+y/2,d=l-v/2,g=l+v/2,h=r,b=r+u,w=n-150-10,I=n-10;if(console.log("for loop"),console.log("carLeft",h),console.log("carRight",b),console.log("carTop",w),console.log("carBottom",I),console.log("obstacleLeft",s),console.log("obstacleRight",i),console.log("obstacleTop",d),console.log("obstacleBottom",g),b>s&&h<i&&I>d&&w<g)return console.log("boom"),!0}}catch(e){o.e(e)}finally{o.f()}return!1}()&&ee(),function(){if(i){var e=Date.now();c=Math.floor((e-a)/1e3),(R=Math.max(q-c,0))<=0&&ee()}!function(){s.save(),s.font="".concat(C,"px ").concat(D),s.fillStyle="#ffffff";var e=N.logo_swan.element;if(s.drawImage(e,5,5,100,100),i){var n=N.timerIcon.element,o=Math.floor(R/60),r=R%60,a="".concat(String(o).padStart(2,"0"),":").concat(String(r).padStart(2,"0")),c=s.measureText(a).width,l=(s.measureText(a).height,20+.5*(30+C)),u=t/2-(80+c)/2;s.drawImage(n,u,20,30,30);var d=u+30+10;s.fillText(a,d,l)}s.restore()}()}()),k&&function(){var e,o;M&&(T+=A)>=1&&(T=1,M=!1),e=O,o=G*T,s.save(),s.fillStyle=e,s.globalAlpha=o,s.fillRect(0,0,t,n),s.restore();var r=document.getElementById("game-over");r.style.opacity=T,r.style.display="flex",document.getElementById("time").innerText=c}(),i||J())}function ce(){i||k||(i=!0,a=Date.now(),ne=setInterval(Q,1e3*B),oe=setInterval(V,1e3*L),K())}l.addEventListener("click",ce),l.addEventListener("touchstart",ce),window.addEventListener("keydown",(function(e){if(i&&!k){var t=Date.now();if(t-Y<F)return;"ArrowLeft"===e.key&&d>0?(d--,Y=t):"ArrowRight"===e.key&&d<g-1&&(d++,Y=t)}ce()})),window.onload=function(){W(),k=!1,M=!1,i=!1,a=null,c=0,f=[],h=[]}}()})();